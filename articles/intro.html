<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prepare file for batch import into ARW • Photo2ARW</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare file for batch import into ARW">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Photo2ARW</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/intro.html">Prepare file for batch import into ARW</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nbelouard/Photo2ARW/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prepare file for batch import into ARW</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nbelouard/Photo2ARW/blob/master/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to create the database for uploading photos
in Batch Import mode into ARW. This vignette requires that you have a
folder that contains all the photos from a transect (or person) at a
date, and <em>only these photos, no other photos, no
subfolders.</em></p>
<p>There are two main steps: - Renaming the photos according to a code
(optional) - Create a data frame that will be imported into ARW Steps
where your input is needed are indicated.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>First setup the librairies. If you don’t have these libraries, you
can install them using “install.packages(nameOfTheLibrary)”</p>
</div>
<div class="section level2">
<h2 id="photo-renaming">Photo renaming<a class="anchor" aria-label="anchor" href="#photo-renaming"></a>
</h2>
<p>Now, let’s rename the photos. The first step is to create a table
that will keep a memory of the raw photo name and the new photo name, in
case we ever need to go back to the initial photos.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#1 **INPUT NEEDED** </span></span>
<span><span class="co">#set the folder containing the photos to import  </span></span>
<span><span class="va">pathToPhotos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#2 get the list of the photos in this folder. Sends an error if no photos are found.</span></span>
<span><span class="op">(</span><span class="va">photoNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rawPhotoNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">pathToPhotos</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># check that these are the expected photos</span></span></code></pre></div>
<pre><code><span><span class="co">##   rawPhotoNames</span></span>
<span><span class="co">## 1     test1.jpg</span></span>
<span><span class="co">## 2     test2.jpg</span></span>
<span><span class="co">## 3     test3.jpg</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nb_photos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">photoNames</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">nb_photos</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Error: no photos in this directory."</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co">#3 extract the EXIF data and check that the photos contain the creation date</span></span>
<span><span class="va">listEXIF</span> <span class="op">&lt;-</span> <span class="fu">read_exif</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pathToPhotos</span>, <span class="va">photoNames</span><span class="op">$</span><span class="va">rawPhotoNames</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"CreateDate"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">listEXIF</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Error: the photos do not have a CreateDate. Rename the photos manually, then use photo2batchimport to create the ARW table"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">listEXIF</span><span class="op">$</span><span class="va">CreateDate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Error: some of the photos do not have a CreateDate. Rename the photos manually, then use photo2batchimport to create the ARW table"</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Photos are appropriate for automatic renaming based on CreateDate."</span><span class="op">)</span></span>
<span>    <span class="va">listEXIF</span> <span class="op">%&lt;&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">FileName</span>, <span class="va">CreateDate</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">CreateDate</span><span class="op">)</span> <span class="co"># sort the photos by CreateDate (chronological order)</span></span>
<span>      <span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Photos are appropriate for automatic renaming based on CreateDate."</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#4 **INPUT NEEDED** </span></span>
<span><span class="co">#determine the base code that you want to rename these photos with. The function will then increment a 3-digit number to each photo </span></span>
<span><span class="va">Code</span> <span class="op">=</span> <span class="st">"PVL_M_05_11_2024"</span></span>
<span></span>
<span><span class="co">#5 create a table containing the raw and new photo names. Check that everything is as expected.</span></span>
<span><span class="op">(</span><span class="va">listEXIF</span> <span class="op">%&lt;&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>newPhotoName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Code</span>, <span class="st">"_"</span>, <span class="fu">str_pad</span><span class="op">(</span><span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>, pad <span class="op">=</span> <span class="fl">0</span>,width <span class="op">=</span> <span class="fl">3</span> , <span class="st">"left"</span><span class="op">)</span>,<span class="st">"_ind.jpg"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>rawPhotoName <span class="op">=</span> <span class="va">FileName</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">CreateDate</span>, <span class="va">rawPhotoName</span>, <span class="va">newPhotoName</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">##   CreateDate          rawPhotoName newPhotoName                </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2024:11:05 22:03:53 test1.jpg    PVL_M_05_11_2024_001_ind.jpg</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2024:11:05 22:05:22 test3.jpg    PVL_M_05_11_2024_002_ind.jpg</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2024:11:05 22:07:37 test2.jpg    PVL_M_05_11_2024_003_ind.jpg</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#6 **INPUT NEEDED**</span></span>
<span><span class="co">#if everything is okay, store this table in a file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">listEXIF</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"exports"</span>, <span class="st">"photoNames_PVL_M_05_11_2024.csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The second step is to actually rename the photos based on the codes
that were defined. For security reasons, the files will be copied to
another folder before being renamed, so that the original photo still
exists.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listEXIF</span><span class="op">$</span><span class="va">rawPhotoName</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pathToPhotos</span>, <span class="va">listEXIF</span><span class="op">$</span><span class="va">rawPhotoName</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"dataRenamed"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.rename</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"dataRenamed"</span>, <span class="va">listEXIF</span><span class="op">$</span><span class="va">rawPhotoName</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"dataRenamed"</span>, <span class="va">listEXIF</span><span class="op">$</span><span class="va">newPhotoName</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="batch-import-prep">Batch Import prep<a class="anchor" aria-label="anchor" href="#batch-import-prep"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#0 set the path to the renamed photos</span></span>
<span><span class="va">pathToPhotos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"dataRenamed"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#1 Create a table with the photo names</span></span>
<span><span class="va">photoNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">pathToPhotos</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">BatchImportdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Encounter.mediaAsset0 <span class="op">=</span> <span class="va">photoNames</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">BatchImportdf</span><span class="op">)</span> <span class="co">#make sure these are the expected photos</span></span></code></pre></div>
<pre><code><span><span class="co">##          Encounter.mediaAsset0</span></span>
<span><span class="co">## 1 PVL_M_05_11_2024_001_ind.jpg</span></span>
<span><span class="co">## 2 PVL_M_05_11_2024_002_ind.jpg</span></span>
<span><span class="co">## 3 PVL_M_05_11_2024_003_ind.jpg</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#2 **INPUT NEEDED**</span></span>
<span><span class="co"># Extract details from the photo name</span></span>
<span><span class="co"># Change the submitterID to your ARW login</span></span>
<span><span class="co"># if this is the first time ever that this site is prospected, and you are confident that there are no duplicates in your photos, you can assign individual names without recognition (= each photo is set to a new individual name) by setting MarkedID = T.</span></span>
<span><span class="va">BatchImportdf_ready</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/photo2batchimport.html">photo2batchimport</a></span><span class="op">(</span><span class="va">BatchImportdf</span>,</span>
<span>                                         submitterID <span class="op">=</span> <span class="st">"JSmith"</span>,</span>
<span>                                         MarkedID <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Take a look at the final table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BatchImportdf_ready</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          Encounter.mediaAsset0 Encounter.day Encounter.month Encounter.year</span></span>
<span><span class="co">## 1 PVL_M_05_11_2024_001_ind.jpg            05              11           2024</span></span>
<span><span class="co">## 2 PVL_M_05_11_2024_002_ind.jpg            05              11           2024</span></span>
<span><span class="co">## 3 PVL_M_05_11_2024_003_ind.jpg            05              11           2024</span></span>
<span><span class="co">##   Encounter.locationID Encounter.verbatimLocality Encounter.sightingID</span></span>
<span><span class="co">## 1            Prevalaye                      PVL_M       PVL_M_05112024</span></span>
<span><span class="co">## 2            Prevalaye                      PVL_M       PVL_M_05112024</span></span>
<span><span class="co">## 3            Prevalaye                      PVL_M       PVL_M_05112024</span></span>
<span><span class="co">##   Encounter.alternateID Encounter.genus Encounter.specificEpithet</span></span>
<span><span class="co">## 1        M_05112024_001      Salamandra                salamandra</span></span>
<span><span class="co">## 2        M_05112024_002      Salamandra                salamandra</span></span>
<span><span class="co">## 3        M_05112024_003      Salamandra                salamandra</span></span>
<span><span class="co">##   Encounter.project0.researchProjectName Encounter.submitterID</span></span>
<span><span class="co">## 1                        Salamandres BZH                JSmith</span></span>
<span><span class="co">## 2                        Salamandres BZH                JSmith</span></span>
<span><span class="co">## 3                        Salamandres BZH                JSmith</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save the table for export - Change the file name to your needs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">BatchImportdf_ready</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"exports"</span>, <span class="st">"PVL_M_05112024.csv"</span><span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Congratulations, this set of photos is ready for upload on ARW!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nadège Belouard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
